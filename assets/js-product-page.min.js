/******/ (() => {
  // webpackBootstrap
  /*!**********************************************!*\
  !*** ./src/scripts/sections/product-page.js ***!
  \**********************************************/
  class ProductGallery {
    constructor() {
      this.mainImage = document.getElementById("mainProductImage");
      this.thumbnails = document.querySelectorAll(
        ".product-gallery__thumbnail",
      );
      this.quantityInput = document.getElementById("quantity");
      this.quantityBtns = document.querySelectorAll(".quantity-btn");

      if (this.mainImage && this.thumbnails.length > 0) {
        this.initGallery();
      }

      if (this.quantityInput && this.quantityBtns.length > 0) {
        this.initQuantitySelector();
      }
    }

    initGallery() {
      this.thumbnails.forEach((thumbnail) => {
        thumbnail.addEventListener("click", (e) => {
          this.selectThumbnail(thumbnail);
        });

        // Keyboard navigation
        thumbnail.addEventListener("keydown", (e) => {
          if (e.key === "Enter" || e.key === " ") {
            e.preventDefault();
            this.selectThumbnail(thumbnail);
          }
        });
      });
    }

    selectThumbnail(thumbnail) {
      const newSrc = thumbnail.getAttribute("data-src");

      // Remove active class from all thumbnails
      this.thumbnails.forEach((thumb) => {
        thumb.classList.remove("active");
      });

      // Add active class to selected thumbnail
      thumbnail.classList.add("active");

      // Update main image with fade effect
      this.mainImage.style.opacity = "0.7";
      this.mainImage.src = newSrc;

      this.mainImage.addEventListener(
        "load",
        () => {
          this.mainImage.style.opacity = "1";
        },
        { once: true },
      );
    }

    initQuantitySelector() {
      const minusBtn = document.querySelector(".quantity-btn.minus");
      const plusBtn = document.querySelector(".quantity-btn.plus");

      minusBtn.addEventListener("click", () => {
        this.decreaseQuantity();
      });

      plusBtn.addEventListener("click", () => {
        this.increaseQuantity();
      });

      // Allow direct input
      this.quantityInput.addEventListener("change", () => {
        this.validateQuantity();
      });

      // Keyboard support
      this.quantityInput.addEventListener("keydown", (e) => {
        if (e.key === "ArrowUp") {
          e.preventDefault();
          this.increaseQuantity();
        } else if (e.key === "ArrowDown") {
          e.preventDefault();
          this.decreaseQuantity();
        }
      });
    }

    increaseQuantity() {
      const currentValue = parseInt(this.quantityInput.value, 10);
      this.quantityInput.value = currentValue + 1;
    }

    decreaseQuantity() {
      const currentValue = parseInt(this.quantityInput.value, 10);
      if (currentValue > 1) {
        this.quantityInput.value = currentValue - 1;
      }
    }

    validateQuantity() {
      const value = parseInt(this.quantityInput.value, 10);
      if (isNaN(value) || value < 1) {
        this.quantityInput.value = 1;
      }
    }
  }

  // Initialize on DOM ready
  document.addEventListener("DOMContentLoaded", () => {
    new ProductGallery();
  });

  // Also initialize if DOM is already loaded
  if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", () => {
      new ProductGallery();
    });
  } else {
    new ProductGallery();
  }

  /******/
})();
